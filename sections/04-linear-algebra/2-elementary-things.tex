\subsection{Элементарные преобразования и элементарные матрицы}

\begin{defn}
    Элементарное преобразование $1$ типа:

    К $i$ строке прибавить $j$ строку, умноженную на $\lambda \in R$. Обозначается $T_{ij}(\lambda)$
\end{defn}

\begin{defn}
    Элементарное преобразование $2$ типа:

    Поменять местами $i$ и $j$ строки. Обозначается $S_{ij}$
\end{defn}

\begin{defn}
    Элементарное преобразование $3$ типа:

    Умножить $i$ строку на $\lambda \in R,~\lambda \neq 0$. Обозначается $D_{ij}(\lambda)$
\end{defn}

\begin{notice}
    Аналогичные преобразования можно делать с столбцами.
\end{notice}

\begin{defn}
    Матрица $A \in M_{m, n}(k)$ называется ступенчатой, если существует $0 \leq r \leq m$ и числа $j_1, \ldots, j_r: 1 \leq j_1 < \ldots < j_r \leq n$ такие, что:
    
    \begin{enumerate}
        \item $a_{kj_k} \neq 0,~k = 1, \ldots, r$
        
        \item $a_{kj} = 0,~k = 1, \ldots, r,~j < j_k$
        
        \item $a_{kj} = 0,~k > r$
    \end{enumerate}
\end{defn} 

\begin{theorem-non}
    Любую матрицу можно превратить в ступенчатую с помощью преобразования строк $1$ и $2$ типа.
\end{theorem-non}

\begin{proof} (короче Гаусса пишем и работает)

    $A = a(i, j) \in M_{m, n}(k)$

    Индукция по $m$.

    База: $m = 1$. $A$ ступенчатая по определению.

    Переход: $m > 1$:

    Если $A = 0$, то $A$ ступенчатая по определению.

    $j_1$ --- номер первого ненулевого столбца. 

    $\exists i : a_{ij_1} \neq 0$

    $i \neq 1 \implies$ применим $S_{1i}$

    Таким образом можно считать $a_{1j_1} \neq 0$.

    Применим $T_{21} \left( -\frac{a_{2j_1}}{a_{1j_1}} \right), T_{31} \left( -\frac{a_{3j_1}}{a_{1j_1}} \right), \ldots, T_{m1} \left( -\frac{a_{mj_1}}{a_{1j_1}} \right)$

    Получим $A' = \begin{pmatrix} a_{11} & a_{12} & \ldots & a_{1n} \\ 0 & a_{22} & \ldots & a_{2n} \\ \vdots & \vdots & \ddots & \vdots \\ 0 & a_{mm} & \ldots & a_{mn} \end{pmatrix}$

    По индукции $A'$ ступенчатая.
\end{proof}

\begin{defn}
    Окаймленная единичная матрица --- матрица вида:

    $\begin{pmatrix}
        1 & 0 & \ldots & 0 & 0 & \ldots & 0 \\
        0 & 1 & \ldots & 0 & 0 & \ldots & 0 \\
        \vdots & \vdots & \ddots & \vdots & \vdots & \ddots & \vdots \\
        0 & 0 & \ldots & 1 & 0 & \ldots & 0 \\
        0 & 0 & \ldots & 0 & 0 & \ldots & 0 \\
        \vdots & \vdots & \ddots & \vdots & \vdots & \ddots & \vdots \\
        0 & 0 & \ldots & 0 & 0 & \ldots & 0
    \end{pmatrix}$
\end{defn}

\begin{theorem}
    Пусть $A \in M_{m, n}(k)$. Тогда ее можно преобразовать в окаемленную единичную с помощью преобразования строк и столбцов.
\end{theorem}

\begin{proof}
    
    Сделаем $A$ ступенчатой.

    Превратим ступеньки разной длины в единичные. (меняя столбцы)

    Применим $D_1(a_{11}^{-1}), \ldots, D_r(a_{rr}^{-1})$. 

    Потом будем от верхней строки к нижней превращать их в строки с одной $1$ и нулями. (вычитая строки)
\end{proof}

\begin{defn} Элементарная матрица:
    
    <<Первого типа>>:

    Пусть $1 \leq i, j \leq n, i \neq j, \lambda \in K$


    $T_{ij}(\lambda)$ --- матрица вида:
    $ \begin{pmatrix}
        1 & 0 & \ldots & 0 & \ldots & 0 \\
        0 & 1 & \ldots & 0 & \ldots & \lambda \\
        \vdots & \vdots & \ddots & \vdots & \ddots & \vdots \\
        0 & 0 & \ldots & 1 & \ldots & 0 \\
        \vdots & \vdots & \ddots & \vdots & \ddots & \vdots \\
        0 & 0 & \ldots & 0 & \ldots & 1
    \end{pmatrix} = E_n + \lambda e_{ij}$

    <<Второго типа>>:

    $S_{ij} = E_n - e_{ii} - e_{jj} + e_{ij} + e_{ji}$

    <<Третьего типа>>:

    $D_i(\lambda) = E_n + (\lambda - 1) e_{ii}$

\end{defn}

\begin{theorem-non}
    Пусть $A \in M_{m, n}(k)$. Тогда при элементарных преобразованиях строк $T_{ij}(\lambda), S_{ij}, D_i(\lambda)$ из $A$ получаются матрицы $T_{ij} A, S_{ij} A, D_i A$.
\end{theorem-non}

\begin{proof}

    $T_{ij} A = $ \TODO{умножить}

    $S_{ij}, D_i(\lambda)$ --- аналогично.
\end{proof}

\begin{follow}~

    \begin{enumerate}
        \item $T_{ij}(-\lambda) T_{ij}(\lambda) = E_n$
        
        \item $S_{ij} S_{ij} = E_n$
        
        \item $D_i(\lambda) D_i(\lambda^{-1}) = E_n$
    \end{enumerate}
\end{follow}

\begin{follow}
    $T_{ij}(\lambda), S_{ij}, D_i(\lambda) \in GL_n(k)$ --- все они обратимы.
\end{follow}

\begin{proof}
    % к чему относится это доказательство?
    
    $A \longrightarrow A'$ --- результат прибавления к $i$ столбцу $j$-го с коэффицентом $\lambda$.

    $\implies (A')^T = T_{ij}(\lambda) A^T$

    $\implies A' = (T_{ij}(\lambda) A^T)^T = (A^T)^T (T_{ij}(\lambda))^T = A T_{ji}(\lambda)$

    Аналогично: элементарные преобразования столбцов $2$ и $3$ типов сводятся к умножению справа на $S_{ij}$ и $D_i(\lambda)$ соответственно.
\end{proof}

\begin{theorem-non} ($PDQ$ --- разложение матриц)

    Пусть $A \in M_{m,n}(k)$. Тогда существуют элементарные матрицы $P_1, \ldots, P_k \in GL_m(k),~Q_1, \ldots, Q_l \in GL_n(k)$, окаймленная единичная матрица $D \in M_{m, n}(k)$, такие, что $A = P_1 \ldots P_k D Q_1 \ldots Q_l$.
\end{theorem-non}

\begin{proof}
    Существуют элементарные преобразования строк и столбцов, превращающие $A$ в окаймленную единичную матрицу $D$.

    $\implies D = \underbrace{u_k \ldots u_1}_{\text{обратимы}} A \underbrace{v_1 \ldots v_l}_{\text{обратимы}}$, где $u_1, \ldots, u_k, v_1, \ldots, v_l$ --- элементарные матрицы

    $\implies A = u_1^{-1} \ldots u_k^{-1} D v_l^{-1} \ldots v_1^{-1}$
\end{proof}

\begin{follow}
    Пусть $A \in M_n(k)$? Тогда условия эквивалентны:

    \begin{enumerate}
        \item $A \in GL_n(k)$
        
        \item $A = P_1 \ldots P_m$, где $P_1, \ldots, P_m$ --- элементарные матрицы
    \end{enumerate}
\end{follow}

\begin{proof}
    <<$2 \implies 1$>>: так как все $P_i \in GL_n(k)$

    <<$1 \implies 2$>>: 

    $A = P_1 \ldots P_k D Q_1 \ldots Q_l, D = \begin{pmatrix}
        E_n & 0 \\
        0 & 0
    \end{pmatrix}$

    $\implies D = P_k^{-1} \ldots P_1^{-1} A Q_l^{-1} \ldots Q_1^{-1} \implies D \in GL_n(k)$

    В $D$ есть нулевая строка $\implies \forall C \in M_n(k)$: в $DC$ есть нулевая строка $\implies DC \neq E_n \implies D = E_n \implies A = P_1 \ldots P_k D Q_1 \ldots Q_l$
\end{proof}